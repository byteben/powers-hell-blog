<!DOCTYPE html>
<html lang=" en" class="antialiased"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Build Azure Functions using PowerShell Core 6 &amp; VS Code! | Powers Hell</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Build Azure Functions using PowerShell Core 6 &amp; VS Code!" />
<meta name="author" content="Ben" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Now that the public preview of PowerShell support for Azure Functions V2 has been released, it only seems fitting that I demonstrate not only how to create a PowerShell function app, but how to create, test AND deploy the function entirely in VS Code!" />
<meta property="og:description" content="Now that the public preview of PowerShell support for Azure Functions V2 has been released, it only seems fitting that I demonstrate not only how to create a PowerShell function app, but how to create, test AND deploy the function entirely in VS Code!" />
<link rel="canonical" href="https://powers-hell.com/2019/05/09/build-azure-functions-using-powershell-core-6-vs-code/" />
<meta property="og:url" content="https://powers-hell.com/2019/05/09/build-azure-functions-using-powershell-core-6-vs-code/" />
<meta property="og:site_name" content="Powers Hell" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-08T19:06:33+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Build Azure Functions using PowerShell Core 6 &amp; VS Code!" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Ben"},"description":"Now that the public preview of PowerShell support for Azure Functions V2 has been released, it only seems fitting that I demonstrate not only how to create a PowerShell function app, but how to create, test AND deploy the function entirely in VS Code!","headline":"Build Azure Functions using PowerShell Core 6 &amp; VS Code!","dateModified":"2019-05-08T19:06:33+00:00","datePublished":"2019-05-08T19:06:33+00:00","url":"https://powers-hell.com/2019/05/09/build-azure-functions-using-powershell-core-6-vs-code/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://powers-hell.com/2019/05/09/build-azure-functions-using-powershell-core-6-vs-code/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/app.css">
    <link rel="stylesheet" href="/assets/css/prism-dracula.css">

</head><body><div class="page-container">
    <div class="">
        <nav class="nav sticky drac-bg-blackBlack">
            <div class="max-w-7xl mx-auto sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16 px-4 sm:px-0">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 link-hover">
                            <h2 class="drac-heading drac-heading-xl"><a href="/">Powers Hell</a></h2>
                        </div>
                        <div class="hidden md:block">
                            <div class="ml-10 flex items-baseline space-x-4">
                                <div class="drac-text drac-text-cyan drac-text-right drac-line-height">
                                    Great power is great fun
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="hidden sm:block">
                        <div class="ml-4 items-center relative">
                            <div>
                                <a href="/"
                                    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan hover:drac-text-white drac-btn-sm drac-m-sm">Home</a>
                                <a href="/about"
                                    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">About</a>
                                <a href="/merch"
                                    class="drac-btn drac-bg-purple-transparent drac-btn-ghost drac-text-cyan drac-btn-sm drac-m-sm">Merch</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>      <div class="drac-bg-blackBlack pb-6 md:pb-24 lg:pb-28 xl:pb-8">
        <header class="py-10">
          <div class="main-overlay max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            
            <h1 class="drac-heading drac-heading-2xl drac-text-center drac-text-cyan">Build Azure Functions using PowerShell Core 6 & VS Code!</h1>
            
          </div>
        </header>
      </div>
      <div>
        <svg class="wave" viewBox="0 0 1792 335" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">
        <path d="M 0 50 C 259 50 259 209 518 209 L 518 209 L 518 0 L 0 0 Z" stroke-width="0"></path>
        <path d="M 517 209 C 800 209 800 96 1083 96 L 1083 96 L 1083 0 L 517 0 Z" stroke-width="0"></path>
        <path d="M 1082 96 C 1437 96 1437 189 1792 189 L 1792 189 L 1792 0 L 1082 0 Z" stroke-width="0"></path>
        </svg>
      </div><main class="-mt-4 md:-mt-64 lg:-mt-72 xl:-mt-80 2xl:-mt-96">
  <div class="main-overlay max-w-5xl mx-auto pb-12 px-4 sm:px-6 lg:px-8">
    <div class=" break-normal md:break-word drac-bg-black rounded-lg shadow-2xl px-5 py-6 sm:px-6">
      <article class="markdown-body drac-text drac-line-height">

        <p class="post-date">Published: 8 May
        </p>
        <p>I’ve been creating Azure Function using PowerShell since it was added as an option in their “Experimental Language Support” in V1.0. In fact, It was almost a year to the day that I wrote my first blog post about how I used <a href="http://powers-hell.com/2018/05/15/working-with-graphapi-powerbi-the-easy-way/">Azure Functions to make PowerBI work nicely with Graph</a>.</p>

<!--more-->

<p>So, it only seems fitting now that the public preview of <a href="https://devblogs.microsoft.com/powershell/public-preview-of-powershell-in-azure-functions-2-x/">PowerShell support for Azure Functions V2 has been released</a>, that I demonstrate not only how to create a PowerShell function, but how to create, test AND deploy the function entirely in VS Code!</p>

<p>Before we get into this amazing new era of serverless computing, we need to set up our development environment with the following pre-requirements:</p>

<ul>
  <li><a href="https://github.com/PowerShell/PowerShell/releases/download/v6.2.0/PowerShell-6.2.0-win-x64.msi">Powershell Core (6.2 Minimum)</a></li>
  <li><a href="https://www.microsoft.com/net/download">.NET Core SDK 2.2+</a></li>
  <li><a href="https://nodejs.org/en/download/">Node.js &amp; NPM</a></li>
  <li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-run-local#v2">Azure Functions Core Tools v2.x</a></li>
  <li><a href="https://code.visualstudio.com/">Visual Studio Code</a> <a href="https://code.visualstudio.com/"></a></li>
  <li><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell">PowerShell extension for Visual Studio Code</a></li>
  <li><a href="https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions">Azure Functions extension for Visual Studio Code</a></li>
</ul>

<p>For the sake of brevity, this guide will assume you are setting your development environment up using a 64-bit Windows operating system.</p>

<p>Once you’ve set up your development environment, fire up VS Code and select the Azure icon in the sidebar.</p>

<p><a href="/assets/images/2019/05/Snag_33ca9090.png" title="VSCode"><img src="/assets/images/2019/05/Snag_33ca9090.png" alt="VSCode" /></a></p>

<p>Sign in to your Azure account by clicking the very obvious link and following the bouncing ball. (This isn’t necessary right now, but it’s handy to connect to you Azure tenant.)</p>

<p>Once you are signed in, you will see your subscription, along with any other existing functions previously created.</p>

<p><a href="/assets/images/2019/05/Snag_33d1dde3.png" title="Azure subscription"><img src="/assets/images/2019/05/Snag_33d1dde3.png" alt="Azure subscription" /></a></p>

<p>Now let’s get started onto the fun stuff. Open up the command palette (F1), search for <strong>Azure Functions</strong> and select <strong>Create New Project…</strong></p>

<p><a href="/assets/images/2019/05/Snag_33d35030.png" title="Create new project"><img src="/assets/images/2019/05/Snag_33d35030.png" alt="Create new project" /></a></p>

<p>Save your project somewhere locally, then select <strong>PowerShell (Preview)</strong> as your development language.</p>

<p><a href="/assets/images/2019/05/Snag_33d46fe8.png" title="Powershell as language"><img src="/assets/images/2019/05/Snag_33d46fe8.png" alt="Powershell as language" /></a></p>

<p>For this scenario we are going to create a basic web API, so select HTTP trigger, but take some time to view all the options now made available to us in Azure Functions V2.0</p>

<p><a href="/assets/images/2019/05/Snag_33d5af3e.png" title="HTTP Trigger"><img src="/assets/images/2019/05/Snag_33d5af3e.png" alt="HTTP Trigger" /></a></p>

<p>Give your function a name, and set the <strong>authorization level</strong> to <strong>Function</strong></p>

<p><a href="/assets/images/2019/05/Snag_33d6a0a3.png" title="Set auth level to function"><img src="/assets/images/2019/05/Snag_33d6a0a3.png" alt="Set auth level to function" /></a></p>

<p>Finally, select <strong>Add to Workspace.</strong></p>

<p><a href="/assets/images/2019/05/Snag_33d76a2d.png" title="Add to workspace"><img src="/assets/images/2019/05/Snag_33d76a2d.png" alt="Add to workspace" /></a></p>

<p>You should now be greeted with the basic scaffold of an Azure Function App. Key files of mention here are:</p>

<ul>
  <li>Function.json - Where all IN / OUT bindings for your function are defined and configured.</li>
  <li>Run.ps1 - The PowerShell code that is run when the function is triggered.</li>
  <li>Host.json - The configuration file for the entire project.</li>
  <li>Local.settings.json - Where all environment variables can be defined.</li>
</ul>

<p>Now let’s run the sample function to make sure everything is working as it should be.</p>

<p>Open <strong>run.ps1</strong> - the first thing we will need to do is switch the Terminal session from the default <strong>5.1</strong> to <strong>PowerShell Core.</strong></p>

<p>On the notifications tray of VS Code click on the green 5.1 PowerShell icon to launch the session menu.</p>

<p><a href="/assets/images/2019/05/Snag_33e109ec.png" title="Switch to PWSH"><img src="/assets/images/2019/05/Snag_33e109ec.png" alt="Switch to PWSH" /></a></p>

<p>In the session menu, select <strong>Switch to: PowerShell Core (x64)</strong> and select <strong>Yes</strong> when asked to start a new session.</p>

<p>You should now see a green 6.2 PowerShell icon in the notifications tray.
Finally, Hit <strong>F5</strong> to launch the function app into VS Code!</p>

<p>Once the app has finished launching, you should see the endpoint URL in the terminal output. Select and copy this to the clipboard.</p>

<p><a href="/assets/images/2019/05/Snag_33e7ac68.png" title="endpoint url"><img src="/assets/images/2019/05/Snag_33e7ac68.png" alt="endpoint url" /></a></p>

<p>Now, let’s switch over to the <strong>PowerShell Console</strong> (or just open up another PowerShell terminal window!)</p>

<p><a href="/assets/images/2019/05/Snag_33fbf75b.png" title="Open terminal"><img src="/assets/images/2019/05/Snag_33fbf75b.png" alt="Open terminal" /></a></p>

<p>The template Function that is provided with the scaffold is a simple “Hello World” HTTP trigger which is simply looking for a <strong>Name</strong> property, so using the URL generated from the Function App, let’s send a request and see what happens.</p>

<pre class="wp-block-code"><code>Invoke-RestMethod -Method Get -Uri http://localhost:7071/api/Powers-Hell_HTTP-Trigger?Name=Ben</code></pre>

<p>When we run that command we should receive back a very exciting response from the Function!</p>

<p><a href="/assets/images/2019/05/Snag_34050019.png" title="Run the command!"><img src="/assets/images/2019/05/Snag_34050019.png" alt="Run the command!" /></a></p>

<p>And there you have it - a locally run Function App using PowerShell Core 6 &amp; VS Code!</p>

<p>Stay tuned for my next post, where I’ll take everything we’ve gone over here and turn it into a way to modernize logon scripts for Intune managed devices!</p>

      </article>
    </div>
  </div>
<div class="main-overlay max-w-5xl mx-auto pb-12 px-4 sm:px-6 lg:px-8 drac-text-white drac-text-center">
    <div class="drac-box drac-mb-sm">
        <hr class="drac-divider drac-border-cyan" />
    </div>
    <h3 class="drac">Related Posts</h3>
    <ul class="related-footer">
        
        <li><a href="/2021/03/08/working-with-intune-settings-catalog-using-powershell-and-graph/">&raquo; Working with Intune Settings Catalog using PowerShell and Graph</a></li>
        
        <li><a href="/2021/01/19/publishing-powershell-scripts-to-intune-with-graph/">&raquo; Publishing PowerShell scripts to Intune with Graph</a></li>
        
        <li><a href="/2020/10/25/deploying-universal-print-printers-with-powershell-intune/">&raquo; Deploying Universal Print Printers With PowerShell & Intune</a></li>
        
        <li><a href="/2020/06/09/installing-fonts-with-powershell-intune/">&raquo; Installing fonts with PowerShell & Intune</a></li>
        
        <li><a href="/2020/05/04/create-a-bootable-windows-10-autopilot-device-with-powershell/">&raquo; Create a bootable Windows 10 Autopilot device with PowerShell!</a></li>
        
    </ul>
</div>

</main>
  </div><script src="/assets/js/app.js"></script>
<script src="/assets/js/prism.js"></script>
<script type="text/javascript" src="/assets/js/lightbox.js"></script>
<script src="/assets/js/termynal.js" data-termynal-container="#termynal"></script>
<link rel="stylesheet" href="/assets/css/lightbox.css">
</div>
<div>
<svg class="wave" viewBox="0 0 1792 95.1" xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink">
<path d="M1792,95.1c0-27,0-54,0-80.9c-40.7-5.1-101.2-11-174.5-12.3c-185.3-3.3-260.9,26.8-411.8,42.6
c-297.5,31.2-285-56-548.1-16.1C536.2,46.6,452.1,77.6,335.5,43C294,30.7,251,10.8,179.2,3C104.9-5,42.2,4.5,0,14.1v80.9H1792z"/>
</svg>
    <footer class="main-overlay drac-bg-blackBlack flex flex-wrap items-center justify-between p-3 m-auto">
        <div class="container mx-auto flex flex-col flex-wrap items-center justify-between">
            <div class="flex mx-auto drac-text-white text-center">
                <span>
                    <p class="drac-text-purple-cyan">
                        Powers Hell © 2021
                    </p>
                </span>
            </div>
            <div class="flex mx-auto drac-text-white text-center">
                <span>
                    <p>
                        made by 
                        <a href="https://twitter.com/powers_hell" target="_blank" class="drac-text-yellow">
                            Ben
                        </a>
                        with
                        <a href="https://github.com/tabs-not-spaces/powers-hell-blog" target="_blank" class="drac-text-yellow-pink">
                            code, coffee & beer
                        </a>
                        🍻
                    </p>
                </span>
            </div>
        </div>
    </footer>
</div></body>

</html>